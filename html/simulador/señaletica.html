<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SimUAM: Señaletica</title>
    <link rel="icon" href="./../../images/ico/logo_azul.ico" type="image/x-icon">
    <style>
        @font-face {
            font-family: "Aptos";
            src: url("./../../font/Aptos.ttf") format("truetype");
            font-weight: normal;
            font-style: normal;
        }

        * {
            font-family: "Aptos", Arial, sans-serif;
        }

        body {
            font-family: "Aptos", Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: #faf9fb;
            color: #222;
        }

        .container {
            max-width: 600px;
            margin: 40px auto 0 auto;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 24px rgba(140, 0, 255, 0.08), 0 1.5px 6px rgba(0, 0, 0, 0.04);
            padding: 32px 36px 24px 36px;
            position: relative;
            min-height: 500px;
        }

        .slide {
            display: none;
            width: 100%;
            min-height: 420px;
            box-sizing: border-box;
            text-align: center;
            background-color: #fff;
            position: absolute;
            top: 0;
            left: 0;
            transition: opacity 0.5s ease-in-out, transform 0.5s ease;
            opacity: 0;
            transform: scale(0.98);
            transform-origin: center center;
            border-radius: 10px;
            padding: 0 10px;
        }

        .slide.active {
            display: block;
            opacity: 1;
            transform: scale(1);
            position: relative;
        }

        .slide img {
            max-width: 80%;
            height: auto;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(140, 0, 255, 0.08);
            animation: fadeInUp 1s ease-out;
            background: #f7f6fa;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translate3d(0, 40px, 0);
            }

            to {
                opacity: 1;
                transform: translate3d(0, 0, 0);
            }
        }

        .slide h1,
        .slide h2 {
            color: rgb(55, 0, 255);
            font-weight: 600;
            margin-bottom: 18px;
            letter-spacing: 0.5px;
            animation: fadeIn 1s ease-in;
        }

        .slide p {
            animation: fadeIn 1s ease-in;
            font-size: 1.05em;
            margin-bottom: 10px;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 24px;
        }

        .nav-button {
            background: none;
            border: 1.5px solid rgb(55, 0, 255);
            color: rgb(55, 0, 255);
            padding: 8px 22px;
            border-radius: 6px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
        }

        .nav-button:hover {
            background: rgb(55, 0, 255);
            color: #fff;
        }

        @media (max-width: 700px) {
            .container {
                padding: 18px 8px 16px 8px;
                min-height: 350px;
            }

            .slide img {
                max-width: 98%;
            }
        }

        /* Estilos para el modal del juego */
        #gameModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(40, 0, 80, 0.18);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        #gameModal>div {
            background: #fff;
            border-radius: 12px;
            max-width: 420px;
            margin: auto;
            padding: 32px 24px;
            box-shadow: 0 8px 32px rgba(55, 0, 255, 0.13);
            position: relative;
        }

        #closeGameBtn {
            position: absolute;
            top: 12px;
            right: 16px;
            background: none;
            border: none;
            font-size: 1.5em;
            color: #888;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div class="container" id="sym:.container">
        <section class="slide active" id="slide1">
            <h1>Señaletica</h1>
            <img src="señaletica/360_logo.png" alt="Imagen de señalización">
            <p>Explora la importancia de las señaleticas y su impacto en diversas áreas en la UAM Cuajimalpa.</p>
        </section>

        <section class="slide" id="slide2">
            <h2>Señal de Extintores</h2>
            <img src="señaletica/señal_extintor.jpg" alt="Conceptos básicos">
            <p>Marcador que informa sobre la presencia de un extintor cercano.</p>
        </section>

        <section class="slide" id="slide3">
            <h2>Extintores</h2>
            <img src="señaletica/extintor.jpg" alt="Conceptos básicos">
            <p>Ubicación de un extintor para combatir incendios de manera rápida.</p>
        </section>

        <section class="slide" id="slide4">
            <h2>Zonas de Menor Riesgo</h2>
            <img src="señaletica/zona_menor.jpg" alt="Conceptos básicos">
            <p>Señal que delimita un área con menor riesgo o acceso restringido.</p>
        </section>

        <section class="slide" id="slide5">
            <h2>En caso de incendio...</h2>
            <img src="señaletica/caso_incendio.jpg" alt="Conceptos básicos">
            <p>Kit de herramientas a utilizar en caso de incendio, contiene un extintor, y manguera para apagar el
                fuego.</p>
        </section>

        <section class="slide" id="slide6">
            <h2>Ruta de Evacuacion</h2>
            <img src="señaletica/ruta_evacuacion.jpg" alt="Conceptos básicos">
            <p>Indica el camino seguro para evacuar en caso de emergencia.</p>
        </section>

        <section class="slide" id="slide7">
            <h2>Espacio libre de humo de tabaco</h2>
            <img src="señaletica/humo_tabaco.jpg" alt="Conceptos básicos">
            <p>Restricción o advertencia sobre zonas donde está prohibido fumar.</p>
        </section>

        <section class="slide" id="slide8">
            <h2>Plafones</h2>
            <img src="señaletica/plafones.jpg" alt="Conceptos básicos">
            <p>Los espacios de la UAM Cuajimalpa estan mayormente compuestos por plafones en los techos, estos no
                presentan un riesgo en caso de siniestro, sin embargo, es mejor prevenir un accidente en caso de caida
                de uno.</p>
        </section>

        <div class="nav-buttons">
            <button class="nav-button" id="prevBtn">&larr; Anterior</button>
            <button class="nav-button" id="nextBtn">Siguiente &rarr;</button>
        </div>
        <div style="text-align:center; margin-top: 20px;">
            <a href="./../inicio/simulador.html"><button class="nav-button">Regresar</button></a>
            <button class="nav-button" id="gameModeBtn" style="margin-left:10px;">Modo de Juego</button>
        </div>
    </div>

    <!-- Juego -->
    <div id="gameModal"
        style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(40,0,80,0.18); z-index:1000; align-items:center; justify-content:center;">
        <div
            style="background:#fff; border-radius:12px; max-width:420px; margin:auto; padding:32px 24px; box-shadow:0 8px 32px rgba(55,0,255,0.13); position:relative;">
            <button id="closeGameBtn"
                style="position:absolute; top:12px; right:16px; background:none; border:none; font-size:1.5em; color:#888; cursor:pointer;">&times;</button>
            <div id="rouletteContainer" style="display:none; text-align:center;">
                <h2 style="color:rgb(55,0,255);">¡Gira la ruleta para elegir el modo de juego!</h2>
                <canvas id="rouletteCanvas" width="260" height="260" style="margin:20px auto; display:block;"></canvas>
                <button class="nav-button" id="spinRouletteBtn">Girar Ruleta</button>
                <div id="rouletteResult" style="margin-top:18px; font-size:1.1em; color:#222;"></div>
            </div>
            <div id="gameContent">

            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const slides = document.querySelectorAll('.slide');
            let currentIndex = 0;

            function showSlide(index) {
                slides.forEach((slide, i) => {
                    if (i === index) {
                        slide.classList.add('active');
                    } else {
                        slide.classList.remove('active');
                    }
                });
            }

            document.getElementById('nextBtn').addEventListener('click', () => {
                currentIndex = (currentIndex + 1) % slides.length;
                showSlide(currentIndex);
            });

            document.getElementById('prevBtn').addEventListener('click', () => {
                currentIndex = (currentIndex - 1 + slides.length) % slides.length;
                showSlide(currentIndex);
            });

            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowRight') {
                    currentIndex = (currentIndex + 1) % slides.length;
                    showSlide(currentIndex);
                }
                if (e.key === 'ArrowLeft') {
                    currentIndex = (currentIndex - 1 + slides.length) % slides.length;
                    showSlide(currentIndex);
                }
            });
        });

        const modosJuego = [
            { nombre: "Simulación", color: "#4682B4" },
            { nombre: "Prueba", color: "#bfa000" },
            { nombre: "Reto rápido", color: "#7c003e" }
        ];
        let modoJuegoSeleccionado = null;

        function drawRoulette(angle = 0) {
            const canvas = document.getElementById('rouletteCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const size = canvas.width;
            const center = size / 2;
            const radius = center - 10;
            ctx.clearRect(0, 0, size, size);

            const slice = 2 * Math.PI / modosJuego.length;
            for (let i = 0; i < modosJuego.length; i++) {
                ctx.beginPath();
                ctx.moveTo(center, center);
                ctx.arc(center, center, radius, angle + i * slice, angle + (i + 1) * slice);
                ctx.closePath();
                ctx.fillStyle = modosJuego[i].color;
                ctx.fill();
                ctx.save();
                ctx.translate(center, center);
                ctx.rotate(angle + (i + 0.5) * slice);
                ctx.textAlign = "right";
                ctx.font = "bold 18px Arial";
                ctx.fillStyle = "#fff";
                ctx.fillText(modosJuego[i].nombre, radius - 18, 8);
                ctx.restore();
            }

            ctx.beginPath();
            ctx.moveTo(center, center - radius + 4);
            ctx.lineTo(center - 12, center - radius - 18);
            ctx.lineTo(center + 12, center - radius - 18);
            ctx.closePath();
            ctx.fillStyle = "#222";
            ctx.fill();
        }

        function spinRoulette() {

            const vueltas = 8 + Math.floor(Math.random() * 3);
            let angle = 0;
            let step = 0;
            let spinning = true;
            let lastFrame = null;
            let selectedIdx = null;

            const idxAleatorio = Math.floor(Math.random() * modosJuego.length);
            const slice = 2 * Math.PI / modosJuego.length;
            const targetAngle = vueltas * 2 * Math.PI + (modosJuego.length - idxAleatorio) * slice + slice / 2;

            function animateRoulette(ts) {
                if (!lastFrame) lastFrame = ts;
                const delta = ts - lastFrame;
                lastFrame = ts;
                if (spinning) {

                    angle += 0.12 + Math.max(0, 0.8 - step / 30);
                    step++;
                    drawRoulette(angle);

                    if (angle >= targetAngle) {
                        spinning = false;
                        selectedIdx = idxAleatorio;
                        modoJuegoSeleccionado = modosJuego[selectedIdx].nombre;
                        drawRoulette(angle);
                        document.getElementById('rouletteResult').innerHTML = `<b>Modo seleccionado: ${modoJuegoSeleccionado}</b>`;
                        setTimeout(() => {
                            document.getElementById('rouletteContainer').style.display = 'none';
                            document.getElementById('gameContent').style.display = '';
                            iniciarJuegoModoSeleccionado();
                        }, 1200);
                    } else {
                        requestAnimationFrame(animateRoulette);
                    }
                }
            }
            document.getElementById('rouletteResult').innerHTML = '';
            requestAnimationFrame(animateRoulette);
        }

        function mostrarRuleta() {
            document.getElementById('gameContent').style.display = 'none';
            document.getElementById('rouletteContainer').style.display = '';
            drawRoulette();
            document.getElementById('rouletteResult').innerHTML = '';
        }

        document.getElementById('spinRouletteBtn').onclick = spinRoulette;

        const preguntasSimulador = [
            {
                pregunta: "¿Qué color indica el cronómetro cuando el tiempo es mayor a 40 segundos en el simulador?",
                opciones: [
                    "Verde",
                    "Amarillo",
                    "Rojo",
                    "Azul"
                ],
                respuesta: 2
            },
            {
                pregunta: "¿Qué botón debes presionar para cambiar la intensidad del sismo en el simulador?",
                opciones: [
                    "Finalizar Ejercicio",
                    "Intensidad",
                    "Ver Recorrido",
                    "Configuración"
                ],
                respuesta: 1
            },
            {
                pregunta: "¿Qué sucede si seleccionas el modo 'Prueba' en el simulador?",
                opciones: [
                    "Puedes elegir piso e intensidad",
                    "Todo es aleatorio: piso, intensidad y tiempo",
                    "Solo puedes cambiar la cámara",
                    "No puedes iniciar el simulador"
                ],
                respuesta: 1
            },
            {
                pregunta: "¿Qué indica la escala de Mercalli en el simulador?",
                opciones: [
                    "El tiempo de evacuación",
                    "La intensidad del sismo según daños observados",
                    "El piso seleccionado",
                    "El modo de juego"
                ],
                respuesta: 1
            },
            {
                pregunta: "¿Qué debes hacer si ves la alerta activada (icono animado) en el simulador?",
                opciones: [
                    "Ignorarla",
                    "Prepararte para evacuar",
                    "Cambiar de piso",
                    "Cerrar el simulador"
                ],
                respuesta: 1
            }
        ];

        const preguntasOriginales = [
            {
                pregunta: "¿Qué indica la señal con un extintor?",
                opciones: [
                    "Zona de fumar",
                    "Ubicación de un extintor",
                    "Salida de emergencia",
                    "Área restringida"
                ],
                respuesta: 1
            },
            {
                pregunta: "¿Qué representa la escala de Mercalli?",
                opciones: [
                    "Intensidad de un sismo según daños observados",
                    "Cantidad de lluvia",
                    "Temperatura ambiente",
                    "Nivel de ruido"
                ],
                respuesta: 0
            },
            {
                pregunta: "¿Qué debes hacer si ves la señal de 'Ruta de evacuación'?",
                opciones: [
                    "Ignorarla",
                    "Seguir la ruta en caso de emergencia",
                    "Cerrar la puerta",
                    "Buscar un extintor"
                ],
                respuesta: 1
            },
            {
                pregunta: "¿Qué significa una zona marcada como 'Espacio libre de humo de tabaco'?",
                opciones: [
                    "Se permite fumar",
                    "No se permite fumar",
                    "Zona de extintores",
                    "Área de juegos"
                ],
                respuesta: 1
            }
        ];

        let preguntas = [];
        function mezclarPreguntas() {
            preguntas = [...preguntasOriginales, ...preguntasSimulador]
                .map(p => ({ sort: Math.random(), value: p }))
                .sort((a, b) => a.sort - b.sort)
                .map(p => p.value);
        }

        let preguntaActual = 0;
        let respuestasCorrectas = 0;

        function mostrarPregunta() {
            if (preguntaActual < preguntas.length) {
                const p = preguntas[preguntaActual];
                let html = `<h2 style="color:rgb(55,0,255);">${p.pregunta}</h2><form id="quizForm">`;
                p.opciones.forEach((op, idx) => {
                    html += `<div style="margin:8px 0;">
                        <label>
                            <input type="radio" name="opcion" value="${idx}" required>
                            ${op}
                        </label>
                    </div>`;
                });
                html += `<button type="submit" class="nav-button" style="margin-top:16px;">Responder</button></form>`;
                document.getElementById('gameContent').innerHTML = html;
                document.getElementById('quizForm').onsubmit = function (e) {
                    e.preventDefault();
                    const seleccion = parseInt(document.querySelector('input[name="opcion"]:checked').value);
                    if (seleccion === p.respuesta) respuestasCorrectas++;
                    preguntaActual++;
                    mostrarPregunta();
                };
            } else {
                mostrarResultado();
            }
        }

        function mostrarResultado() {
            let html = `<h2 style="color:rgb(55,0,255);">¡Juego terminado!</h2>
                <p>Modo jugado: <b>${modoJuegoSeleccionado || "No seleccionado"}</b></p>
                <p>Respuestas correctas: <b>${respuestasCorrectas}</b> de <b>${preguntas.length}</b></p>
                <button class="nav-button" id="retryBtn">Intentar de nuevo</button>`;
            document.getElementById('gameContent').innerHTML = html;
            document.getElementById('retryBtn').onclick = () => {
                preguntaActual = 0;
                respuestasCorrectas = 0;
                mostrarRuleta();
            };
        }

        function iniciarJuegoModoSeleccionado() {
            preguntaActual = 0;
            respuestasCorrectas = 0;
            mezclarPreguntas();
            mostrarPregunta();
        }

        document.getElementById('gameModeBtn').onclick = () => {
            document.getElementById('gameModal').style.display = 'flex';
            mostrarRuleta();
        };
        document.getElementById('closeGameBtn').onclick = () => {
            document.getElementById('gameModal').style.display = 'none';
        };

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.getElementById('gameModal').style.display = 'none';
            }
        });
    </script>
</body>

</html>